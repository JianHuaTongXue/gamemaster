<div class="pageContent" xmlns:th="http://www.w3.org/1999/xhtml">
    <form method="post" onsubmit="return closeNavTab(this);" action="operatingTools/sendmail" class="pageForm required-validate">
        <table width="98%" style="border-collapse:separate; border-spacing:5px;">
            <thead>
            <tr>
                <th width="20%"></th>
                <th width="80%"></th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>邮件类型：</td>
                <td>
                    <select name="mailType" id="mailType" onchange="mailTypeOnchange(this)">
                        <option value="1">全服群发</option>
                        <option value="2">等级范围群发</option>
                        <option value="3">角色群发</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>选择区服：</td>
                <td>
                    <select name="serverId" class="required">
                        <option th:each="server:${serverList}" th:value="${server.serverId}" th:utext="${server.serverName}"></option>
                    </select>
                </td>
            </tr>
            <tr id="playerids" hidden="hidden">
                <td>角色ID：<br/>玩家id1,<br/>玩家id2,</td>
                <td>
                    <textarea name="playerids" class="textArea" cols="30" rows="4" style="resize: none"></textarea>
                </td>
            </tr>
            <tr id="minLevel" hidden="hidden">
                <td>最小等级：</td>
                <td><input type="number" name="minLev"/></td>
            </tr>
            <tr id="maxLevel" hidden="hidden">
                <td>最大等级：</td>
                <td><input type="number" name="maxLev"/></td>
            </tr>
            <tr>
                <td>发件人：</td>
                <td><input type="text" title="发件人" value="系统邮件" name="sender" class="required textInput"/></td>
            </tr>
            <tr>
                <td>邮件标题：</td>
                <td><input type="text" title="标题" value="" name="title" class="required textInput"/></td>
            </tr>
            <tr>
                <td>邮件内容：</td>
                <td>
                    <textarea name="content" class="required textArea" cols="30" rows="4"
                              style="resize: none"></textarea>
                </td>
            </tr>
            <tr>
                <td>物品：</td>
                <td>
                    <select id="mail_goods">
                        <option th:each="goods:${goodsList}" th:text="${goods.name}" th:value="${goods.id}"></option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>数量：</td>
                <td><input type="number" id="mail_count" min="1"/><input type="button" value="添加" id="addButton"/></td>
            </tr>
            <tr>
                <td>奖励：</td>
                <td>
                    <textarea name="rewards" class="textArea readonly" cols="30" rows="4"
                              style="resize: none;margin-top: 10px" id="reward" readonly="readonly"></textarea>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <button type="submit">发送</button>
                    <button class="close">取消</button>
                </td>
            </tr>
            </tbody>
        </table>
    </form>
</div>
<script type="text/javascript">
    $(function () {
        $('#mail_goods').searchableSelect();
    });

    $('#addButton').click(function () {
        var goods = $('#mail_goods').val();
        var count = $('#mail_count').val();
        if(count>0){
            $('#reward').val($('#reward').val() + goods + ":" + count + ";\n");
        }else{
            alert("请选择物品数量");
        }
    });

    function mailTypeOnchange(mailType) {
        var mailType = $(mailType).val();
        if (mailType == 1) {
            $('#minLevel').hide();
            $('#minLevel input').removeClass("required");

            $('#maxLevel').hide();
            $('#maxLevel input').removeClass("required");

            $('#playerids').hide();
            $('#playerids textarea').removeClass("required");
        } else if (mailType == 2) {
            $('#minLevel').show();
            $('#minLevel input').addClass("required");

            $('#maxLevel').show();
            $('#maxLevel input').addClass("required");

            $('#playerids').hide();
            $('#playerids textarea').removeClass("required");
        } else if (mailType == 3) {
            $('#playerids').show();
            $('#playerids textarea').addClass("required");

            $('#minLevel').hide();
            $('#minLevel input').removeClass("required");

            $('#maxLevel').hide();
            $('#maxLevel input').removeClass("required");
        }
    }
</script>
